exports.jobType="task-per-node";exports.name="clear_pq";const fs=require("fs");let outputId;const{util:{resolveEnvVars},internal:{PersistentQueue:{outputPath}}}=C;exports.initJob=async t=>{const{conf:s}=t.conf.executor;outputId=s.outputId};exports.jobSeedTask=async()=>({task:{outputId}});exports.initTask=async t=>{};exports.jobOnError=async(t,s,e)=>{};exports.taskExecute=async(t,s)=>{const e=t.logger();e.info("task opts",{opts:s});const o=outputPath(s.outputId);if(!o)throw{message:"Misconfigured persstent queue path"};const r=resolveEnvVars(o);const u=await fs.promises.readdir(r);return Promise.all(u.map((async t=>fs.promises.rm(`${r}/${t}/${s.outputId}`,{recursive:true,force:true}))))};